"use strict";(self.webpackChunkpen_and_paper=self.webpackChunkpen_and_paper||[]).push([[650],{650:(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});var r=t(43),n=t(579);const o=e=>{let{onLogin:s,onLogout:t}=e;const[o,l]=(0,r.useState)(null),[i,a]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[m,u]=(0,r.useState)(!1),g=(0,r.useRef)(null),x=(0,r.useRef)(null),h=e=>{try{const t=JSON.parse(atob(e.credential.split(".")[1])),r={name:t.name,email:t.email,picture:t.picture};l(r),localStorage.setItem("user",JSON.stringify(r)),null===s||void 0===s||s(r)}catch(c){console.error("Error parsing Google response:",c)}};(0,r.useEffect)((()=>{const e=localStorage.getItem("user");if(e)try{l(JSON.parse(e))}catch(c){console.error("Error parsing saved user:",c),localStorage.removeItem("user")}}),[]),(0,r.useEffect)((()=>{if(m||o)return;(()=>{if(window.google)return void u(!0);const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{u(!0)},e.onerror=()=>{console.error("Failed to load Google Identity Services script"),d("Failed to load Google services")},document.head.appendChild(e)})()}),[m,o]),(0,r.useEffect)((()=>{if(m&&!o){const e=setTimeout((()=>{(()=>{try{if(!window.google||!x.current||o)return;x.current.innerHTML="",window.google.accounts.id.initialize({client_id:"339241384511-4srj07ljhqvv75ah1roi185hiqnhomo4.apps.googleusercontent.com",callback:h}),window.google.accounts.id.renderButton(x.current,{theme:"filled_black",size:"medium",type:"standard",shape:"rectangular",text:"signin_with"}),console.log("Google Identity Services initialized successfully")}catch(e){console.error("Error initializing Google Identity Services:",e),d("Failed to initialize Google login")}})()}),100);return()=>{clearTimeout(e),x.current&&(x.current.innerHTML="")}}}),[m,o]),(0,r.useEffect)((()=>{const e=localStorage.getItem("user");if(e)try{l(JSON.parse(e))}catch(c){console.error("Error parsing saved user:",c),localStorage.removeItem("user")}}),[]);return(0,r.useEffect)((()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&a(!1)};return i&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[i]),(0,n.jsxs)("div",{className:"relative",children:[o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{onClick:()=>{a(!i)},className:"flex items-center space-x-1 bg-gray-800 hover:bg-gray-700 rounded-md sm:rounded-lg px-1.5 py-1 sm:px-2 sm:py-1.5 md:px-3 md:py-2 transition-colors cursor-pointer",children:[(0,n.jsx)("img",{src:o.picture,alt:o.name,className:"w-5 h-5 sm:w-6 sm:h-6 md:w-8 md:h-8 rounded-full flex-shrink-0"}),(0,n.jsx)("span",{className:"text-white font-medium max-w-12 xs:max-w-16 sm:max-w-20 md:max-w-32 truncate text-xs sm:text-sm hidden xs:inline",children:o.name}),(0,n.jsx)("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-white flex-shrink-0 hidden xs:inline",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),i&&(0,n.jsx)("div",{ref:g,className:"absolute right-0 top-full mt-2 bg-white rounded-lg shadow-lg border border-gray-200 min-w-48 sm:min-w-64 z-50",children:(0,n.jsxs)("div",{className:"p-3 sm:p-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3 mb-3 sm:mb-4",children:[(0,n.jsx)("img",{src:o.picture,alt:o.name,className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full flex-shrink-0"}),(0,n.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,n.jsx)("div",{className:"font-medium text-gray-900 text-sm sm:text-base truncate",children:o.name}),(0,n.jsx)("div",{className:"text-xs sm:text-sm text-gray-500 truncate",children:o.email})]})]}),(0,n.jsx)("button",{onClick:()=>{l(null),localStorage.removeItem("user"),null===t||void 0===t||t(),a(!1)},className:"w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors text-sm sm:text-base",children:"Logout"})]})})]}):(0,n.jsx)("div",{className:"flex-shrink-0 scale-75 xs:scale-90 sm:scale-100 origin-center",children:(0,n.jsx)("div",{ref:x,className:"inline-block google-btn-container"})}),c&&(0,n.jsx)("div",{className:"text-red-600 mt-2 text-xs sm:text-sm",children:c}),(0,n.jsx)("style",{children:"\n          .google-btn-container span {\n            font-weight: 600 !important;\n          }\n        "})]})}}}]);
//# sourceMappingURL=650.d332ab11.chunk.js.map